(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{124:function(e,t){},156:function(e,t,a){},158:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(30),c=a.n(r),s=a(13),l=a(14),i=a(16),h=a(15),u=a(17),p=a(3),d=a(161),f=a(159),m=a(160),g=a(20),b=a.n(g),k="https://english-book-reader.herokuapp.com",v=a(6),C=a(49),O=a.n(C);var j=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(h.a)(t).call(this,e))).state={filename:"",output:"",input:"",chaptersTexts:["q"],chaptersTitles:[],currentPage:1,currentChapter:1,modalIsOpen:!1},a.translate=a.translate.bind(Object(p.a)(Object(p.a)(a))),a.findWord=a.findWord.bind(Object(p.a)(Object(p.a)(a))),a.first=a.first.bind(Object(p.a)(Object(p.a)(a))),a.selectChapter=a.selectChapter.bind(Object(p.a)(Object(p.a)(a))),a.openModal=a.openModal.bind(Object(p.a)(Object(p.a)(a))),a.closeModal=a.closeModal.bind(Object(p.a)(Object(p.a)(a))),a.modalTriggerButton=o.a.createRef(),a.clickButton=a.clickButton.bind(Object(p.a)(Object(p.a)(a))),console.log("Book construct"),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){console.log("Book componentDidMount"),console.log("props=",this.props);var e=this.props.match.params.file;console.log("filename=",e),"undefined"!=typeof e&&this.props.onHandleBookChanged(e);var t=this.props.currentChapter;"undefined"!=typeof t&&this.setState({currentChapter:t}),this.openBook(e)}},{key:"clickButton",value:function(){console.log("shsrh"),this.modalTriggerButton.current.props.onClick()}},{key:"openModal",value:function(){this.setState({modalIsOpen:!0}),this.clickButton()}},{key:"closeModal",value:function(){this.setState({modalIsOpen:!1})}},{key:"first",value:function(){console.log("first"),this.setState(function(e){return{currentChapter:1}})}},{key:"selectChapter",value:function(e){this.props.onCurrentChapterChanged(e),this.setState(function(t){return{currentChapter:e}}),window.scrollTo(0,0)}},{key:"translate",value:function(e,t){var a=this;b.a.get(k+"/api/get-translate/"+e).then(function(e){var t=e.data.data;a.setState({output:t}),a.openModal()}).catch(function(e){return console.log(e)})}},{key:"openBook",value:function(e){var t=this;b.a.get(k+"/api/get-book/"+e).then(function(e){var a=e.data,n=a.data.split(/CHAPTER\s\w*|Chapter\s\w*/g);n.splice(0,1),t.setState({input:a.data,chaptersTitles:a.data.match(/CHAPTER\s\w*|Chapter\s\w*/g),chaptersTexts:n})})}},{key:"findWord",value:function(e){e.preventDefault();for(var t=window.getSelection(),a=t.getRangeAt(0),n=t.anchorNode;0!==a.toString().indexOf(" ");)a.setStart(n,a.startOffset-1);a.setStart(n,a.startOffset+1);do{a.setEnd(n,a.endOffset+1)}while(-1===a.toString().indexOf(" ")&&""!==a.toString().trim()&&a.endOffset<n.length);var o=a.toString().trim();this.translate(o,"ru")}},{key:"render",value:function(){var e=this;console.log("book render",this.state.filename,this.state.currentChapter);var t=this.state.currentChapter,a="";return this.state.chaptersTexts.length>t-1&&(a=function(e){return e="<p>"+(e=(e=(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/\r\n?|\n/g,"<br>")).replace(/<br>\s*<br>/g,"</p><p>"))+"</p>"}(this.state.chaptersTexts[t-1])),o.a.createElement("div",{className:"TranslateForm"},o.a.createElement(v.Pagination,{items:this.state.chaptersTexts.length,activePage:t,maxButtons:7,onSelect:function(t){console.log("selectCh",t),e.selectChapter(t)}}),o.a.createElement("div",{onClick:this.findWord},O()(a)),o.a.createElement(v.Modal,{trigger:o.a.createElement(v.Button,{style:{display:"none"},ref:this.modalTriggerButton},"MODAL"," ")},this.state.output),o.a.createElement(v.Pagination,{items:this.state.chaptersTexts.length,activePage:t,maxButtons:7,onSelect:function(t){console.log("selectCh",t),e.selectChapter(t)}}))}}]),t}(n.Component),B=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(i.a)(this,Object(h.a)(t).call(this))).state={bookList:[]},e.openBookList=e.openBookList.bind(Object(p.a)(Object(p.a)(e))),console.log("ListBook construct"),e.openBookList(),e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"openBookList",value:function(){var e=this;b.a.get(k+"/api/get-listBooks").then(function(t){var a=t.data;console.log("ListBook resp",a),e.setState({bookList:a.data})})}},{key:"renderItem2",value:function(e){var t="/book/"+e;return o.a.createElement(v.CollectionItem,{key:e},o.a.createElement(f.a,{to:t},e))}},{key:"renderItem",value:function(e){return o.a.createElement("p",{key:e},o.a.createElement(f.a,{to:{pathname:"/book/"+e}},e))}},{key:"render",value:function(){return console.log("ListBook render"),o.a.createElement(v.Collection,null,this.state.bookList.map(this.renderItem2))}}]),t}(n.Component),E=a(154),y=function(e){function t(){var e;Object(s.a)(this,t),e=Object(i.a)(this,Object(h.a)(t).call(this));var a=E.getItem("fileName");null===a&&(a="");var n=E.getItem("chapter");return n=null===n?1:parseInt(n),console.log("loadLocalStorage",a,n),e.chapter=n,e.state={fileName:a},console.log("App constructor"),e.handleBookChanged=e.handleBookChanged.bind(Object(p.a)(Object(p.a)(e))),e.handleChapterChanged=e.handleChapterChanged.bind(Object(p.a)(Object(p.a)(e))),e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){console.log("App componentDidMount")}},{key:"handleChapterChanged",value:function(e){this.chapter=e,E.setItem("chapter",this.chapter)}},{key:"handleBookChanged",value:function(e){E.setItem("fileName",e),console.log(" localStorage.setItem(fileName",e),this.state.fileName!==e&&(this.setState({fileName:e}),this.chapter=1,E.setItem("chapter",1))}},{key:"render",value:function(){var e=this;return console.log("App render"),o.a.createElement(d.a,{basename:"/book-reader"},o.a.createElement("div",null,o.a.createElement(v.Navbar,{left:!0},o.a.createElement(v.NavItem,null,o.a.createElement(f.a,{to:"/"},"Books")),o.a.createElement(v.NavItem,null,o.a.createElement(f.a,{to:{pathname:"/book/"+this.state.fileName}},this.state.fileName))),o.a.createElement(m.a,{exact:!0,path:"/",render:function(t){return o.a.createElement(B,Object.assign({},t,{onHandleBookChanged:e.handleBookChanged}))}}),o.a.createElement(m.a,{exact:!0,path:"/book/:file",render:function(t){return o.a.createElement(j,Object.assign({},t,{onCurrentChapterChanged:e.handleChapterChanged,onHandleBookChanged:e.handleBookChanged,currentChapter:e.chapter}))}}),o.a.createElement(m.a,{path:"/topics"})))}}]),t}(n.Component);a(156);c.a.render(o.a.createElement(y,null),document.getElementById("root"))},52:function(e,t,a){e.exports=a(158)}},[[52,2,1]]]);
//# sourceMappingURL=main.9ca0b5c0.chunk.js.map